<!-- FILEPATH: /Users/richardolarez/SeniorCapstone/24040FlaskFramework/templates/EDV.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Project View</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='index.css') }}">
    <script src="https://unpkg.com/htmx.org@latest"></script>

    <style>
        #myTable{
            width: 90%;
        }
        .container {
            right: 0;
            overflow-y: auto;
            position: relative;
            height: calc(100vh - 100px);   
        }
        .left, .right {
            flex: 1; /* Each section takes up equal space */
            flex-direction: column;
            padding: 20px; /* Optional: Adds some padding inside sections */
            align-items: center;
            text-align: center;
            justify-content: flex-start;
        }        
        
        .footer{
            align-content: center;
        }

        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            overflow: auto; /* Enable scroll if needed */
            align-items: center;
            justify-content: center;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            background-color: rgb(7, 7, 7); /* Fallback color */
            background-color: rgba(7, 7, 7, 0.9); /* Black w/ opacity */
        }
    </style>
</head>

   
<body>
  <!-- Banner -->
    <div class="banner">
        <img src=static/images/Engineering.png alt="Engineering">
        <img src=static/images/NGC.png alt="NGC logo">
    </div>
      <!-- Side bar -->
      <div class="sidebar">
        <ul >
          <li><a href="/home">Home</a></li>
          <li><a href="/menu">Main Menu</a></li>
          <li><a href="/export_project/1">Export</a></li>
          <li><a href="/">Logout</a></li>
        </ul>
      </div>

    <!-- Start Logo Background -->
    <div class="logo" style="background-image: url(static/images/Janusimage.png);">
    <div class="container">
      <!-- Display Project Name Based on session storage variable -->
      <h3 class="name2">Project Name: <span id="projectName"></span></h3>
      
      <!-- Start of Tables -->
        <div id="tables-container"></div>
        <!-- Battery Address Table -->
        <div id="batteryAdressesTable"></div>

            <!-- Battery Address Modal -->
            <div id="addBatteryModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>Add New Battery Address</h2>
                    <form id="addBatteryForm">
                        <label for="batteryName">Battery Name:</label>
                        <select id="batteryName" name="battery" required>
                            <option value="">Select a battery</option>
                            <!-- Fetch options from endpoint and populate the select element -->
                            <script>
                            // Fetch and populate options for the battery select element
                            fetch('/batteries/' + sessionStorage.getItem("projectId"))
                                            .then(response => response.json())
                                            .then(data => {
                                                if (Array.isArray(data)) {
                                                    const batterySelect = document.getElementById('batteryName');
                                                    data.forEach(item => {
                                                        const option = document.createElement('option');
                                                        option.value = item.componentName;
                                                        option.textContent = item.componentName;
                                                        batterySelect.appendChild(option);
                                                    });
                                                } else {
                                                    console.error('Invalid data format received from API');
                                                }
                                            })
                                            .catch(error => {
                                                console.error('Error fetching data:', error);
                                            });
                            </script>
                        </select><br><br>
                        <label for="rs485Address">RS485 Address:</label>
                        <input type="text" id="rs485Address" name="rs485_address" required><br><br>
                        <button type="submit">Submit</button>
                    </form>
                </div>
            </div>
            <!-- End of Battery Address Modal -->
        <!-- End of Battery Address Table -->



        <!-- Battery Default Table -->
        <div id="batteryDefaultTable"></div>
        <!-- Battery Default Modal -->
        <div id="addBatteryDefaultModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Add New Battery Default</h2>
                <form id="addBatteryDefaultForm">
                    <label for="batteryName">Battery Name:</label>
                    <select id="batteryName_DefaultTable" name="battery" required>
                        <option value="">Select a battery</option>
                        <!-- Fetch options from endpoint and populate the select element -->
                        <script>
                            // Fetch and populate options for the battery select element
                            fetch('/batteries/' + sessionStorage.getItem("projectId"))
                                            .then(response => response.json())
                                            .then(data => {
                                                if (Array.isArray(data)) {
                                                    const batterySelect_DefaultTable = document.getElementById('batteryName_DefaultTable');
                                                    data.forEach(item => {
                                                        const option = document.createElement('option');
                                                        option.value = item.componentName;
                                                        option.textContent = item.componentName;
                                                        batterySelect_DefaultTable.appendChild(option);
                                                    });
                                                } else {
                                                    console.error('Invalid data format received from API');
                                                }
                                            })
                                            .catch(error => {
                                                console.error('Error fetching data:', error);
                                            });
                        </script>
                    </select><br><br>
                    <label for="capacity">Capacity:</label>
                    <input type="text" id="capacity" name="capacity" required><br><br>
                    <label for="dischargeCurrent">Discharge Current:</label>
                    <input type="text" id="dischargeCurrent" name="discharge_current" required><br><br>
                    <button type="submit">Submit</button>
                </form>
            </div>
        </div>
        <!-- End of Battery Default Modal -->

        <!-- Start of Charge Mode Table -->
        <div id="chargeModeTable"></div>
        <!-- End of Charge Mode Table -->
        <!-- Start of Charge Mode Modal -->
        <div id="addChargeModeModal" class="modal">
            <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Add New Charge Mode</h2>
            <form id="addChargeModeForm">
                <label for="powerSupply">Power Supply:</label>
                <select id="powerSupply" name="power_supply" required>
                    <option value="">Select a power supply</option>
                    <!-- Fetch options from endpoint and populate the select element -->
                    <script>
                        // Fetch and populate options for the power supply select element
                        fetch('/power_supplies/' + sessionStorage.getItem("projectId"))
                                        .then(response => response.json())
                                        .then(data => {
                                            if (Array.isArray(data)) {
                                                const powerSupplySelect = document.getElementById('powerSupply');
                                                data.forEach(item => {
                                                    const option = document.createElement('option');
                                                    option.value = item.componentName;
                                                    option.textContent = item.componentName;
                                                    powerSupplySelect.appendChild(option);
                                                });
                                            } else {
                                                console.error('Invalid data format received from API');
                                            }
                                        })
                                        .catch(error => {
                                            console.error('Error fetching data:', error);
                                        });
                    </script>
                </select><br><br>
                <label for="battery">Battery:</label>
                <select id="batteryName_ChargeMode" name="battery" required>
                    <option value="">Select a battery</option>
                    <!-- Fetch options from endpoint and populate the select element -->
                    <script>
                        // Fetch and populate options for the battery select element
                        fetch('/batteries/' + sessionStorage.getItem("projectId"))
                                        .then(response => response.json())
                                        .then(data => {
                                            if (Array.isArray(data)) {
                                                const batterySelect_ChargeMode = document.getElementById('batteryName_ChargeMode');
                                                data.forEach(item => {
                                                    const option = document.createElement('option');
                                                    option.value = item.componentName;
                                                    option.textContent = item.componentName;
                                                    batterySelect_ChargeMode.appendChild(option);
                                                });
                                            } else {
                                                console.error('Invalid data format received from API');
                                            }
                                        })
                                        .catch(error => {
                                            console.error('Error fetching data:', error);
                                        });
                    </script>
                </select><br><br>
                <label for="voltageSetting">Voltage Setting:</label>
                <input type="text" id="voltageSetting" name="voltage_setting" required><br><br>
                <label for="ovp">OVP:</label>
                <input type="text" id="ovp" name="ovp" required><br><br>
                <label for="currentSetting">Current Setting:</label>
                <input type="text" id="currentSetting" name="current_setting" required><br><br>
                <label for="currentLimit">Current Limit:</label>
                <input type="text" id="currentLimit" name="current_limit" required><br><br>
                <label for="redGreenCurrentLimits">Red Green Current Limits:</label>
                <input type="text" id="redGreenCurrentLimits" name="red_green_current_limits" required><br><br>
                <label for="redGreenVoltageLimits">Red Green Voltage Limits:</label>
                <input type="text" id="redGreenVoltageLimits" name="red_green_voltage_limits" required><br><br>
                <button type="submit">Submit</button>
            </form>
            </div>
        </div>
        <!-- End of Charge Mode Modal -->

        <!-- Start of Devices Table -->
        <div id="devicesTable"></div>
        <!-- End of Devices Table -->
        
        <!-- Start of Devices Modal -->
        <div id="addDeviceModal" class="modal">
            <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Add New Device</h2>
            <form id="addDeviceForm">
                <label for="deviceName">Device Name:</label>

                <select id="deviceName" name="deviceName" required>
                    <option value="">Select a device</option>
                    <!-- fetch components per projectid -->
                    <script>
                        fetch('/components/' + sessionStorage.getItem("projectId"))
                            .then(response => response.json())
                            .then(data => {
                                if (Array.isArray(data)) {
                                    const deviceTypeSelect = document.getElementById('deviceName');
                                    data.forEach(item => {
                                        const option = document.createElement('option');
                                        option.value = item.componentName;
                                        option.textContent = item.componentName;
                                        deviceTypeSelect.appendChild(option);
                                    });
                                } else {
                                    console.error('Invalid data format received from API');
                                }
                            })
                            .catch(error => {
                                console.error('Error fetching data:', error);
                            });
                    </script>
                </select><br><br>
                <label for="samplingRate">Sampling Rate:</label>
                <input type="text" id="samplingRate" name="sampling_rate" required><br><br>
                <button type="submit">Submit</button>
            </form>
            </div>
            
        </div>
        <!-- End of Devices Modal -->

        
        <!-- Component Table -->
        <div id="tableContainer"></div>
        <!-- End of Tables -->
    </div>
    </div>
    <!-- End of Logo Background -->  

    <script>
        // _______- Devices Table______________________________________________________
        function showDevices() {
            var projectId = sessionStorage.getItem("projectId");
            fetch('/devices/' + projectId)
                .then(response => response.json())
                .then(data => {
                    if (Array.isArray(data)) {
                        window.devices = data;
                        showDevicesTable();
                    } else {
                        console.error('Invalid data format received from API');
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        }

        function generateDevicesTable(data) {
            let table = '<table class="table">';
            // Table caption (title)
            table += '<caption class="name2">Devices</caption>';
            // Generate table header
            table += '<thead class="table-header">';
            table += '<tr>';
            table += '<th class="table-titles">ID</th>';
            table += '<th class="table-titles">Device Name</th>';
            table += '<th class="table-titles">Sampling Rate</th>';
            table += '</tr>';
            table += '</thead>';
            // Generate table body
            table += '<tbody class="table-body">';
            if (data.length > 0) {
                data.forEach(item => {
                    table += '<tr>';
                    table += `<td class="table-cell">${item.id}</td>`;
                    table += `<td class="table-cell">${item.device}</td>`;
                    table += `<td class="table-cell">${item.sampling_rate}</td>`;
                    table += '</tr>';
                });
            } else {
                table += '<tr><td colspan="3">No data available</td></tr>';
            }
            table += '</tbody>';

            table += '</table>';
            table += '<button class="table" onclick="openAddDeviceModal()">Add New Device</button>';
            return table;
        }

        // Modal functions for adding a new device
        // Function to open the modal
        function openAddDeviceModal() {
            var modal = document.getElementById('addDeviceModal');
            modal.style.display = "block";
        }
        
        // Function to close the modal
        document.getElementsByClassName("close")[0].addEventListener("click", function() {
            var modal = document.getElementById('addDeviceModal');
            modal.style.display = "none";
        });

        // Function to handle form submission from device modal
        document.getElementById("addDeviceForm").addEventListener("submit", function(event) {
            event.preventDefault();
            var formData = new FormData(this);
            fetch('/devices', {
            method: 'POST',
            headers: {
            'Content-Type': 'application/json'
            },
            body: JSON.stringify({
            projectID: sessionStorage.getItem("projectId"),
            device: formData.get('deviceName'),
            sampling_rate: formData.get('sampling_rate')
            })
            })
            .then(response => response.json())
            .then(data => {
            // Assuming data is the newly added device object returned by the server
            console.log('New device added:', data);
            // Close the modal
            var modal = document.getElementById('addDeviceModal');
            modal.style.display = "none";
            // Refresh the table
            showDevices(); // Call the function to fetch and display devices
            })
            .catch(error => {
            console.error('Error adding device:', error);
            });
        });

        function showDevicesTable() {
            const tableContainer = document.getElementById('devicesTable');
            tableContainer.innerHTML = generateDevicesTable(window.devices);
            tableContainer.classList.remove('hidden');
        }

        // _______________________________________ End of Devices Table _______________________________________

        // _______- Charge Mode Table ______________________________________________________
        function showChargeMode() {
            var projectId = sessionStorage.getItem("projectId");
            fetch('/charge_mode/' + projectId)
                .then(response => response.json())
                .then(data => {
                    if (Array.isArray(data)) {
                        window.chargeMode = data;
                        showChargeModeTable();
                    } else {
                        console.error('Invalid data format received from API');
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        }

        function generateChargeModeTable(data){
            let table = '<table class="table">';
            // Table caption (title)
            table += '<caption class="name2">Charge Mode</caption>';
            // Generate table header
            table += '<thead class="table-header">';
            table += '<tr>';
            table += '<th class="table-titles">ID</th>';
            table += '<th class="table-titles">Power Supply</th>';
            table += '<th class="table-titles">Battery</th>';
            table += '<th class="table-titles">Voltage Setting</th>';
            table += '<th class="table-titles">OVP</th>';
            table += '<th class="table-titles">Current Setting</th>';
            table += '<th class="table-titles">Current Limit</th>';
            table += '<th class="table-titles">Red Green Current Limits</th>';
            table += '<th class="table-titles">Red Green Voltage Limits</th>';
            table += '</tr>';
            table += '</thead>';
            // Generate table body
            table += '<tbody class="table-body">';
            if (data.length > 0) {
                data.forEach(item => {
                    table += '<tr>';
                    table += `<td class="table-cell">${item.id}</td>`;
                    table += `<td class="table-cell">${item.power_supply}</td>`;
                    table += `<td class="table-cell">${item.battery}</td>`;
                    table += `<td class="table-cell">${item.voltage_setting}</td>`;
                    table += `<td class="table-cell">${item.ovp}</td>`;
                    table += `<td class="table-cell">${item.current_setting}</td>`;
                    table += `<td class="table-cell">${item.current_limit}</td>`;
                    table += `<td class="table-cell">${item.red_green_current_limits}</td>`;
                    table += `<td class="table-cell">${item.red_green_voltage_limits}</td>`;
                    table += '</tr>';
                });
            } else {
                table += '<tr><td colspan="9">No data available</td></tr>';
            }
            table += '</tbody>';

            table += '</table>';
            table += '<button class="table" onclick="openAddChargeModeModal()">Add New Charge Mode</button>';
            return table;
        }

        // Modal functions for adding a new charge mode
        // Function to open the modal
        function openAddChargeModeModal() {
            var modal = document.getElementById('addChargeModeModal');
            modal.style.display = "block";
        }

        // Function to close the modal
        document.getElementsByClassName("close")[0].addEventListener("click", function() {
            var modal = document.getElementById('addChargeModeModal');
            modal.style.display = "none";
        });

        // Function to handle form submission from charge mode modal
        document.getElementById("addChargeModeForm").addEventListener("submit", function(event) {
            event.preventDefault();
            var formData = new FormData(this);
            fetch('/charge_mode', {
            method: 'POST',
            headers: {
            'Content-Type': 'application/json'
            },
            body: JSON.stringify({
            projectID: sessionStorage.getItem("projectId"),
            power_supply: formData.get('power_supply'),
            battery: formData.get('battery'),
            voltage_setting: formData.get('voltage_setting'),
            ovp: formData.get('ovp'),
            current_setting: formData.get('current_setting'),
            current_limit: formData.get('current_limit'),
            red_green_current_limits: formData.get('red_green_current_limits'),
            red_green_voltage_limits: formData.get('red_green_voltage_limits')
            })
            })
            .then(response => response.json())
            .then(data => {
            // Assuming data is the newly added charge mode object returned by the server
            console.log('New charge mode added:', data);
            // Close the modal
            var modal = document.getElementById('addChargeModeModal');
            modal.style.display = "none";
            // Refresh the table
            showChargeMode(); // Call the function to fetch and display charge modes
            })
            .catch(error => {
            console.error('Error adding charge mode:', error);
            });
        });

        function showChargeModeTable() {
            const tableContainer = document.getElementById('chargeModeTable');
            tableContainer.innerHTML = generateChargeModeTable(window.chargeMode);
            tableContainer.classList.remove('hidden');
        }

        // _______________________________________ End of Charge Mode Table _______________________________________

        // _______- Battery Default Table ______________________________________________________

        // Show battery default table
        function showBatteryDefault() {
            var projectId = sessionStorage.getItem("projectId");
            fetch('/battery_default/' + projectId)
                .then(response => response.json())
                .then(data => {
                    if (Array.isArray(data)) {
                        window.batteryDefault = data;
                        showBatteryDefaultTable();
                    } else {
                        console.error('Invalid data format received from API');
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        }

        function generateBatteryDefaultTable(data) {
            let table = '<table class="table">';
            // Table caption (title)
            table += '<caption class="name2">Battery Default</caption>';
            // Generate table header
            table += '<thead class="table-header">';
            table += '<tr>';
            table += '<th class="table-titles">ID</th>';
            table += '<th class="table-titles">Battery</th>';
            table += '<th class="table-titles">Capacity</th>';
            table += '<th class="table-titles">Discharge Current</th>';
            table += '</tr>';
            table += '</thead>';
            // Generate table body
            table += '<tbody class="table-body">';
            if (data.length > 0) {
                data.forEach(item => {
                    table += `<td class="table-cell">${item.id}</td>`;
                    table += `<td class="table-cell">${item.battery}</td>`;
                    table += `<td class="table-cell">${item.capacity}</td>`;
                    table += `<td class="table-cell">${item.discharge_current}</td>`;
                    table += '</tr>';
                });
            } else {
                table += '<tr><td colspan="3">No data available</td></tr>';
            }
            table += '</tbody>';

            table += '</table>';
            table += '<button class="table" onclick="openAddBatteryDefaultModal()">Add New Battery Default</button>';
            return table;
        }

        // Modal functions for adding a new battery default
         // Function to open the modal
        function openAddBatteryDefaultModal() {
            var modal = document.getElementById('addBatteryDefaultModal');
            modal.style.display = "block";
        }

        // Function to close the modal
        document.getElementsByClassName("close")[0].addEventListener("click", function() {
            var modal = document.getElementById('addBatteryDefaultModal');
            modal.style.display = "none";
        });

        // Event listener to handle form submission
        document.getElementById("addBatteryDefaultForm").addEventListener("submit", function(event) {
            event.preventDefault();
            var formData = new FormData(this);
            fetch('/battery_default', {
            method: 'POST',
            headers: {
            'Content-Type': 'application/json'
            },
            body: JSON.stringify({
            projectID: sessionStorage.getItem("projectId"),
            battery: formData.get('battery'),
            capacity: formData.get('capacity'),
            discharge_current: formData.get('discharge_current')
            })
            })
            .then(response => response.json())
            .then(data => {
            // Assuming data is the newly added battery default object returned by the server
            console.log('New battery default added:', data);
            // Close the modal
            var modal = document.getElementById('addBatteryDefaultModal');
            modal.style.display = "none";
            // Refresh the table
            showBatteryDefault(); // Call the function to fetch and display battery defaults
            })
            .catch(error => {
            console.error('Error adding battery default:', error);
            });
        });
        

        function showBatteryDefaultTable() {
            const tableContainer = document.getElementById('batteryDefaultTable');
            tableContainer.innerHTML = generateBatteryDefaultTable(window.batteryDefault);
            tableContainer.classList.remove('hidden');
        }
        

        // _______________________________________ End of Battery Default Table _______________________________________

        function showBatteryAdresses() {
            var projectId = sessionStorage.getItem("projectId");
            fetch('/battery_addresses/' + projectId)
                .then(response => response.json())
                .then(data => {
                    if (Array.isArray(data)) {
                        window.batteryAdresses = data;
                        showBatteryAdressesTable();
                    } else {
                        console.error('Invalid data format received from API');
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        }

        function showComponents() {
            var projectId = sessionStorage.getItem("projectId");
            fetch('/components/' + projectId)
                .then(response => response.json())
                .then(data => {
                    if (Array.isArray(data)) {
                        window.tableItems = data;
                        showTable();
                    } else {
                        console.error('Invalid data format received from API');
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        }


        function generateBatteryAdresses(data) {
            let table = '<table class="table">';
            // Table caption (title)
            table += '<caption class="name2">Battery Addresses</caption>';
            // Generate table header
            table += '<thead class="table-header">';
            table += '<tr>';
            table += '<th class="table-titles">ID</th>';
            table += '<th class="table-titles">Battery</th>';
            table += '<th class="table-titles">RS485 Address</th>';
            table += '</tr>';
            table += '</thead>';
            // Generate table body
            table += '<tbody class="table-body">';
            if (data.length > 0) {
                data.forEach(item => {
                    table += `<tr onclick="selectProject('${item.id}')" style="cursor: pointer;">`; // Added style to change cursor to pointer
                    table += `<td class="table-cell">${item.id}</td>`;
                    table += `<td class="table-cell">${item.battery}</td>`;
                    table += `<td class="table-cell">${item.rs485_address}</td>`;
                    table += '</tr>';
                });
            } else {
                table += '<tr><td colspan="3">No data available</td></tr>';
            }
            table += '</tbody>';

            table += '</table>';
            table += '<button class="table" onclick="openAddBatteryModal()">Add New Battery Address</button>';
            return table;
        }

        // Modal functions for adding a new battery address
         // Function to open the modal
        function openAddBatteryModal() {
            var modal = document.getElementById('addBatteryModal');
            modal.style.display = "block";
        }

        // Function to close the modal
        document.getElementsByClassName("close")[0].addEventListener("click", function() {
            var modal = document.getElementById('addBatteryModal');
            modal.style.display = "none";
        });

        // Function to handle form submission
        document.getElementById("addBatteryForm").addEventListener("submit", function(event) {
            event.preventDefault();
            var formData = new FormData(this);
            fetch('/battery_addresses', {
            method: 'POST',
            headers: {
            'Content-Type': 'application/json'
            },
            body: JSON.stringify({
            projectID: sessionStorage.getItem("projectId"),
            battery: formData.get('battery'),
            rs485_address: formData.get('rs485_address')
            })
            })
            .then(response => response.json())
            .then(data => {
            // Assuming data is the newly added battery address object returned by the server
            console.log('New battery address added:', data);
            // Close the modal
            var modal = document.getElementById('addBatteryModal');
            modal.style.display = "none";
            // Refresh the table
            showBatteryAdresses(); // Call the function to fetch and display battery addresses
            })
            .catch(error => {
            console.error('Error adding battery address:', error);
            });
        });

        function generateComponentTable(data) {
          let table = '<table class="table">';
          // Table caption (title)
          table += '<caption class="name2">Project Identified Components</caption>';
          // Generate table header
          table += '<thead class="table-header">';
          table += '<tr>';
          table += '<th class="table-titles">ID</th>';
          table += '<th class="table-titles">Component</th>';
          table += '<th class="table-titles">Type</th>';
          table += '<th class="table-titles">Part Number</th>';
          table += '<th class="table-titles">Project ID</th>'
          table += '</tr>';
          table += '</thead>';
          // Generate table body
          table += '<tbody class="table-body">';
          if (data.length > 0) {
              data.forEach(item => {
              table += '<tr>';
              table += `<td class="table-cell">${item.componentId}</td>`;
              table += `<td class="table-cell">${item.componentName}</td>`;
              table += `<td class="table-cell">${item.componentType}</td>`;
              table += `<td class="table-cell">${item.partNumber}</td>`;
              table += `<td class='table-cell'>${item.projectId}</td>`;
              table += '</tr>';
              });
          } else {
              table += '<tr><td colspan="4">No data available</td></tr>';
          }
          table += '</tbody>';
          table += '</table>';
          return table;
        }
      
      function showBatteryAdressesTable() {
          const tableContainer = document.getElementById('batteryAdressesTable');
          tableContainer.innerHTML = generateBatteryAdresses(window.batteryAdresses);
          tableContainer.classList.remove('hidden');
      }

      function showTable() {
            const tableContainer = document.getElementById('tableContainer');
            tableContainer.innerHTML = generateComponentTable(window.tableItems);
            tableContainer.classList.remove('hidden');
      }

      // Register event listeners without invoking the functions
      window.addEventListener('DOMContentLoaded', showBatteryAdresses);
      window.addEventListener('DOMContentLoaded', showComponents);
      window.addEventListener('DOMContentLoaded', showBatteryDefault);
      window.addEventListener('DOMContentLoaded', showChargeMode);
      window.addEventListener('DOMContentLoaded', showDevices);

      // Retrieve the project name from session storage
      var projectName = sessionStorage.getItem("projectName");

      // Update the HTML with the project name
      document.getElementById("projectName").innerText = projectName;

      // Retrieve the project id from session storage
      var projectId = sessionStorage.getItem("projectId"); 
    </script>

</body>
</html>